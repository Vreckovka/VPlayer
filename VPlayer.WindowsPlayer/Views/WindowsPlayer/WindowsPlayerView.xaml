<UserControl x:Class="VPlayer.Player.Views.WindowsPlayer.WindowsPlayerView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:behaviors="clr-namespace:VPlayer.Player.Behaviors"
             xmlns:converters="clr-namespace:VCore.Converters;assembly=VCore"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:design1="clr-namespace:VPlayer.Player.Design"
             xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
             xmlns:library="clr-namespace:VPlayer.Library;assembly=VPlayer.Library"
             xmlns:local="clr-namespace:VPlayer.Player.Views"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:text="clr-namespace:VCore.Behaviors.Text;assembly=VCore"
             xmlns:windowsPlayer="clr-namespace:VPlayer.WindowsPlayer"
             d:DataContext="{d:DesignInstance Type={x:Type design1:PlayerDesingViewModel},
                                              IsDesignTimeCreatable=True}"
             d:DesignHeight="450"
             d:DesignWidth="900"
             Background="{StaticResource BackgroudBrush}"
             mc:Ignorable="d">
  <UserControl.Resources>
    <ResourceDictionary>
      <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="pack://application:,,,/VPlayer.WindowsPlayer;component/Views/WindowsPlayer/WindowsPlayerViewResources.xaml" />
      </ResourceDictionary.MergedDictionaries>
    </ResourceDictionary>
  </UserControl.Resources>

  <Grid>
    <Grid.RowDefinitions>
      <RowDefinition Height="*" />
      <RowDefinition Height="auto" />
      <RowDefinition Height="auto" />
      <RowDefinition Height="auto" />
    </Grid.RowDefinitions>

    <Grid.ColumnDefinitions>
      <ColumnDefinition Width="*" />
      <ColumnDefinition Width="5" />
      <ColumnDefinition Width="370" />
    </Grid.ColumnDefinitions>

    <Grid Grid.Column="0">
      <Grid.RowDefinitions>
        <RowDefinition Height="*" />
      </Grid.RowDefinitions>

      <Grid VerticalAlignment="Stretch">
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="*" />
          <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <Image Grid.Column="0"
               Source="{Binding ActualSong.Image}"
               Stretch="UniformToFill" />

        <Image Grid.Column="1"
               Source="{Binding ActualSong.Image}"
               Stretch="UniformToFill" />

        <Grid Grid.RowSpan="2"
              Grid.ColumnSpan="2"
              HorizontalAlignment="Stretch"
              VerticalAlignment="Stretch">
          <Grid.Background>
            <LinearGradientBrush StartPoint="0,1" EndPoint="0 0">
              <GradientStop Offset="1" Color="#5A000000" />
              <GradientStop Offset="0.6" Color="#5A000000" />
              <GradientStop Offset="0.05" Color="#5A000000" />
            </LinearGradientBrush>
          </Grid.Background>
        </Grid>
      </Grid>

      <Grid Grid.Row="0">
        <Grid.Background>
          <LinearGradientBrush StartPoint="1,0" EndPoint="0 0">
            <GradientStop Offset="1" Color="#FF000000" />
            <GradientStop Offset="0.5" Color="#00000000" />
            <GradientStop Offset="0.0" Color="#00000000" />
            <GradientStop Offset="0.0" Color="#FF000000" />
          </LinearGradientBrush>
        </Grid.Background>
      </Grid>

      <Border HorizontalAlignment="Center"
              VerticalAlignment="Center"
              Panel.ZIndex="0"
              BorderBrush="#FF080808"
              BorderThickness="5">
        <Image Name="Image"
               Source="{Binding ActualSong.Image}"
               Stretch="Uniform" />
        <Border.Effect>
          <DropShadowEffect BlurRadius="20"
                            Direction="0"
                            ShadowDepth="15" />
        </Border.Effect>
      </Border>

      <Grid Grid.Row="0">
        <Grid.Background>
          <LinearGradientBrush StartPoint="0,1" EndPoint="0 0">
            <GradientStop Offset="1" Color="#2A000000" />
            <GradientStop Offset="0.85" Color="#00000000" />
            <GradientStop Offset="0.15" Color="#00000000" />
            <GradientStop Offset="0.0" Color="#2A000000" />
          </LinearGradientBrush>
        </Grid.Background>
      </Grid>

      <Grid Grid.Row="0"
            Width="{Binding ElementName=Image, Path=ActualWidth}"
            Height="{Binding ElementName=Image, Path=ActualHeight}">
        <Grid.Background>
          <LinearGradientBrush StartPoint="1,0" EndPoint="0 1">
            <GradientStop Offset="1" Color="#80000000" />
            <GradientStop Offset="0.65" Color="#00000000" />
            <GradientStop Offset="0.35" Color="#00000000" />
            <GradientStop Offset="0.0" Color="#80000000" />
          </LinearGradientBrush>
        </Grid.Background>
      </Grid>

      <Grid Height="75"
            VerticalAlignment="Bottom"
            Background="#AB000000">

        <Button Width="50"
                Margin="10,0,0,15"
                HorizontalAlignment="Left"
                VerticalAlignment="Bottom"
                Command="{Binding AlbumDetail}"
                FontSize="36">
          <Button.Style>
            <Style BasedOn="{StaticResource BorderlessButtonStyle}" TargetType="Button">
              <Setter Property="FontWeight" Value="Bold" />
              <Setter Property="Foreground" Value="#FF454555" />
              <Setter Property="Content">
                <Setter.Value>
                  <Grid>
                    <Grid Width="15"
                          Height="35"
                          VerticalAlignment="Center"
                          Background="White" />
                    <Path Data="M49.52,38.12c3.06,0,5.52-2.52,5.52-5.58c0-3-2.46-5.52-5.52-5.52S44,29.54,44,32.54C44,35.6,46.46,38.12,49.52,38.12z                             M55.4,45.86c0-2.52-2.04-4.5-4.5-4.5h-4.5c-2.52,0-4.5,1.98-4.5,4.5c0,2.46,1.98,4.5,4.5,4.5V63.5c-2.52,0-4.5,2.04-4.5,4.5                             c0,2.52,1.98,4.5,4.5,4.5h9c2.46,0,4.5-1.98,4.5-4.5c0-2.46-2.04-4.5-4.5-4.5V45.86z M50,5c24.84,0,45,20.16,45,45S74.84,95,50,95                             C25.1,95,5,74.84,5,50S25.1,5,50,5z"
                          Fill="{Binding RelativeSource={RelativeSource AncestorType=Button, Mode=FindAncestor}, Path=Foreground}"
                          Stroke="{Binding RelativeSource={RelativeSource AncestorType=Button, Mode=FindAncestor}, Path=Foreground}"
                          StrokeThickness="0.2"
                          Style="{StaticResource Information}" />
                  </Grid>
                </Setter.Value>
              </Setter>
              <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                  <Trigger.EnterActions>
                    <BeginStoryboard>
                      <Storyboard>
                        <ColorAnimation Storyboard.TargetProperty="(Button.Foreground).(SolidColorBrush.Color)"
                                        From="#FF454555"
                                        To="{StaticResource DefaultRedColor}"
                                        Duration="0:0:0:0.25" />
                      </Storyboard>
                    </BeginStoryboard>
                  </Trigger.EnterActions>
                  <!--<Setter Property="Foreground" Value="{StaticResource DefaultRedBrush}" />-->
                </Trigger>
              </Style.Triggers>
            </Style>
          </Button.Style>
          <Button.ToolTip>
            <ToolTip Margin="0"
                     Padding="5,0,5,0"
                     Background="#FF202020"
                     BorderThickness="0"
                     Content="Info"
                     FontFamily="pack://application:,,,/VPlayer.VPlayer;component/Resources/#Montserrat-Light"
                     FontSize="18"
                     FontWeight="Light"
                     Foreground="#DCFFFFFF"
                     IsOpen="False" />
          </Button.ToolTip>
        </Button>

        <StackPanel Name="Container"
                    Width="450"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    ClipToBounds="True">
          <TextBlock Margin="0,-12,0,0"
                     FontSize="35"
                     Foreground="#FFFFFF"
                     Name="NameTxt"
                     Text="{Binding ActualSong.Name}">
            <TextBlock.Style>
              <Style TargetType="TextBlock">
                <Setter Property="HorizontalAlignment" Value="Center" />
                <Style.Triggers>
                  <DataTrigger Value="True">
                    <DataTrigger.Binding>
                      <MultiBinding Converter="{library:IsBiggerConverter}">
                        <Binding ElementName="NameTxt" Path="ActualWidth" />
                        <Binding ElementName="Container" Path="ActualWidth" />
                      </MultiBinding>
                    </DataTrigger.Binding>
                    <Setter Property="HorizontalAlignment" Value="Left" />
                  </DataTrigger>
                </Style.Triggers>
              </Style>
            </TextBlock.Style>
            <TextBlock.Effect>
              <DropShadowEffect BlurRadius="2" ShadowDepth="3" />
            </TextBlock.Effect>

            <i:Interaction.Behaviors>
              <text:PanningTextWithFontSizeBehavior BiggerFontSize="35"
                                                    Container="{Binding ElementName=Container}"
                                                    IgnoreSizeAnimation="{Binding IsPlaying}"
                                                    IsMouseOverRelativeToContainer="True" />
            </i:Interaction.Behaviors>
          </TextBlock>

          <TextBlock HorizontalAlignment="Center"
                     FontFamily="{StaticResource Montserrat_Thin}"
                     FontSize="16"
                     Foreground="#AAEFEFDF">
            <Run Text="{Binding ActualSong.ArtistViewModel.Name, Mode=OneWay}" />
            <Run Text="{Binding ActualSong.AlbumViewModel.Name, Mode=OneWay, StringFormat={}({0})}" />

            <TextBlock.Effect>
              <DropShadowEffect BlurRadius="2" ShadowDepth="2" />
            </TextBlock.Effect>
          </TextBlock>
        </StackPanel>

        <ToggleButton Margin="0,0,5,5"
                      HorizontalAlignment="Right"
                      VerticalAlignment="Bottom"
                      BorderThickness="0"
                      Foreground="#DB505050"
                      IsChecked="{Binding IsRepeate}"
                      Style="{StaticResource RefreshButton}" />

        <ToggleButton Margin="0,0,35,5"
                      HorizontalAlignment="Right"
                      VerticalAlignment="Bottom"
                      BorderThickness="0"
                      Foreground="#DB505050"
                      IsChecked="{Binding IsShuffle}"
                      Style="{StaticResource ShuffleButton}" />
      </Grid>
    </Grid>

    <GridSplitter Grid.RowSpan="3"
                  Grid.Column="1"
                  Margin="2,0,0,0"
                  HorizontalAlignment="Stretch"
                  IsEnabled="False">
      <GridSplitter.Style>
        <Style TargetType="GridSplitter">
          <Setter Property="Width" Value="2" />
          <Setter Property="Background" Value="{StaticResource 30_WhiteTransparentBrush}" />
        </Style>
      </GridSplitter.Style>
    </GridSplitter>

    <Grid Grid.Row="0"
          Grid.RowSpan="3"
          Grid.Column="2">
      <Grid.RowDefinitions>
        <RowDefinition Height="auto"/>
        <RowDefinition/>
      </Grid.RowDefinitions>

      <Grid Height="55">
        <Button Content="Save playlist" HorizontalAlignment="Left" Command="{Binding SavePlaylistCommandCommand}"/>
      </Grid>

      <ListView x:Name="ListView_Tracks"
               Grid.Row="1"
                Margin="1,0,0,0"
                HorizontalAlignment="Stretch"
                Panel.ZIndex="0"
                AllowDrop="True"
                Background="{StaticResource BackgroudBrush}"
                ItemTemplate="{StaticResource SoundTrackTemplate}"
                ItemsSource="{Binding PlayList}"
                ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                Style="{StaticResource WindowsPlayerSongs}">
        <i:Interaction.Triggers>
          <i:EventTrigger EventName="MouseDoubleClick">
            <i:InvokeCommandAction Command="{Binding NextSong}" CommandParameter="{Binding ElementName=ListView_Tracks, Path=SelectedItem}" />
          </i:EventTrigger>
        </i:Interaction.Triggers>
      </ListView>
    </Grid>
  

    <Slider x:Name="Slider_Time"
            Grid.Row="1"
            Margin="0"
            Padding="0"
            IsMoveToPointEnabled="True"
            Maximum="1"
            Value="{Binding ActualSong.ActualPosition}">
      <i:Interaction.Behaviors>
        <behaviors:SliderValueChangedManualy Kernel="{Binding Kernel}" Duration="{Binding ActualSong.Duration}" />
      </i:Interaction.Behaviors>
    </Slider>

    <TextBlock Grid.Row="2"
               HorizontalAlignment="Left"
               FontSize="14"
               Foreground="{StaticResource 120_WhiteTransparentBrush}"
               Text="{Binding ActualSong.ActualTime, StringFormat=hh\\:mm\\:ss}" />
    <TextBlock Grid.Row="2"
               Grid.Column="0"
               HorizontalAlignment="Right"
               FontSize="14"
               Foreground="{StaticResource 120_WhiteTransparentBrush}"
               Text="{Binding ActualSong.Duration, Converter={converters:TimeConverter TimeType=Second}}" />
  </Grid>
</UserControl>