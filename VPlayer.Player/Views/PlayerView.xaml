<UserControl x:Class="VPlayer.Player.Views.PlayerView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:b="http://schemas.microsoft.com/xaml/behaviors"
             xmlns:behaviors="clr-namespace:VPlayer.WindowsPlayer.Behaviors;assembly=VPlayer.WindowsPlayer"
             xmlns:behaviors1="clr-namespace:VPlayer.Player.Behaviors"
             xmlns:behaviors2="clr-namespace:VPlayer.Player.Behaviors;assembly=VPlayer.WindowsPlayer"
             xmlns:controls1="clr-namespace:VCore.Controls;assembly=VCore.WPF"
             xmlns:converters="clr-namespace:VPlayer.Player.Converters"
             xmlns:converters1="clr-namespace:VCore.Converters;assembly=VCore.WPF"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:local="clr-namespace:VPlayer.Player.Views"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:status="clr-namespace:VPlayer.Core.Managers.Status;assembly=VPlayer.Core"
             mc:Ignorable="d">

  <UserControl.Resources>
    <converters:DataContextChangedConverter x:Key="DataContextChangedConverter" />
    <DataTemplate x:Key="StatusMessageDataTemplate">
      <Border Padding="10">
        <Grid>
          <Grid.RowDefinitions>
            <RowDefinition />
            <RowDefinition />
            <RowDefinition />
          </Grid.RowDefinitions>

          <Grid.ColumnDefinitions>
            <ColumnDefinition />
            <ColumnDefinition />
            <ColumnDefinition />
          </Grid.ColumnDefinitions>

          <TextBlock Grid.Column="0"
                     Foreground="#555555"
                     Text="{Binding Message, Mode=OneWay}" />

          <TextBlock Grid.Row="1">
            <TextBlock.Style>
              <Style TargetType="TextBlock" />
            </TextBlock.Style>
            <Run Text="{Binding ActualMessageStatusState, Mode=OneWay}">
              <Run.Style>
                <Style TargetType="Run">
                  <Style.Triggers>
                    <DataTrigger Binding="{Binding ActualMessageStatusState}" Value="{x:Static status:MessageStatusState.Beggining}">
                      <Setter Property="Foreground" Value="Yellow" />
                    </DataTrigger>
                    <DataTrigger Binding="{Binding ActualMessageStatusState}" Value="{x:Static status:MessageStatusState.Processing}">
                      <Setter Property="Foreground" Value="YellowGreen" />
                    </DataTrigger>
                    <DataTrigger Binding="{Binding ActualMessageStatusState}" Value="{x:Static status:MessageStatusState.Done}">
                      <Setter Property="Foreground" Value="Green" />
                    </DataTrigger>
                    <DataTrigger Binding="{Binding ActualMessageStatusState}" Value="{x:Static status:MessageStatusState.Failed}">
                      <Setter Property="Foreground" Value="Red" />
                    </DataTrigger>
                  </Style.Triggers>
                </Style>
              </Run.Style>
            </Run>
            <Run Foreground="#858585" Text="{Binding Process, StringFormat={}{0:N2}%, Mode=OneWay}" />
          </TextBlock>

          <TextBlock Grid.Row="2" Foreground="#454545">
            <Run Text="{Binding ProcessedCount, Mode=OneWay}" />
            <Run Text="/" />
            <Run Text="{Binding NumberOfProcesses, Mode=OneWay}" />
          </TextBlock>

          <Grid.Style>
            <Style TargetType="Grid">
              <Setter Property="Opacity" Value="0" />
              <Style.Triggers>
                <DataTrigger Binding="{Binding ActualMessageStatusState}" Value="{x:Static status:MessageStatusState.Done}">
                  <DataTrigger.EnterActions>
                    <RemoveStoryboard BeginStoryboardName="ShowMessageStoryBoard" />
                    <BeginStoryboard x:Name="HideMessageStoryBoard">
                      <Storyboard>
                        <DoubleAnimation BeginTime="0:0:2"
                                         Storyboard.TargetProperty="Opacity"
                                         From="1.0"
                                         To="0.0"
                                         Duration="0:0:0:0.5" />
                      </Storyboard>
                    </BeginStoryboard>
                  </DataTrigger.EnterActions>

                </DataTrigger>

                <DataTrigger Binding="{Binding Converter={StaticResource DataContextChangedConverter}}" Value="True">
                  <DataTrigger.EnterActions>
                    <RemoveStoryboard BeginStoryboardName="HideMessageStoryBoard" />
                    <BeginStoryboard x:Name="ShowMessageStoryBoard">
                      <Storyboard>
                        <DoubleAnimation Storyboard.TargetProperty="Opacity"
                                         From="0.0"
                                         To="1.0"
                                         Duration="0:0:0:0.2" />
                      </Storyboard>
                    </BeginStoryboard>
                  </DataTrigger.EnterActions>
                </DataTrigger>
              </Style.Triggers>
            </Style>
          </Grid.Style>
        </Grid>
      </Border>
    </DataTemplate>
  </UserControl.Resources>

  <Grid>
    <Border Margin="0,0,0,3"
            HorizontalAlignment="Center"
            CornerRadius="5">
      <Grid>
        <Grid Width="578" HorizontalAlignment="Center">
          <Grid.RowDefinitions>
            <RowDefinition Height="auto" />
            <RowDefinition Height="auto" />
          </Grid.RowDefinitions>

          <Grid Margin="0,0,0,-20">
            <Grid.RowDefinitions>
              <RowDefinition Height="auto" />
              <RowDefinition Height="auto" />
            </Grid.RowDefinitions>

            <Slider Grid.Row="0"
                    Margin="10,0,10,0"
                    Padding="0"
                    Background="Yellow"
                    DataContext="{Binding ActualViewModel}"
                    IsMoveToPointEnabled="True"
                    Maximum="1"
                    Style="{StaticResource ShadowLess}"
                    Value="{Binding ActualItem.ActualPosition}">
              <b:Interaction.Behaviors>
                <behaviors2:SliderValueChangedManualy Duration="{Binding ActualItem.Duration}" />
              </b:Interaction.Behaviors>
            </Slider>


            <TextBlock Grid.Row="1"
                       Margin="10,0,0,0"
                       HorizontalAlignment="Left"
                       FontSize="14"
                       FontWeight="Bold"
                       Foreground="{StaticResource 120_WhiteTransparentBrush}"
                       Text="{Binding ActualItem.ActualTime, StringFormat=hh\\:mm\\:ss}" />
            <TextBlock Grid.Row="1"
                       Margin="0,0,5,0"
                       HorizontalAlignment="Right"
                       FontSize="14"
                       FontWeight="Bold"
                       Foreground="{StaticResource 120_WhiteTransparentBrush}"
                       Text="{Binding ActualItem.Duration, Converter={converters1:TimeConverter TimeType=Second}}" />

            <Grid.Style>
              <Style TargetType="Grid">
                <Setter Property="Visibility" Value="Collapsed" />
                <Style.Triggers>
                  <DataTrigger Binding="{Binding IsFullScreen}" Value="True">
                    <Setter Property="Visibility" Value="Visible" />
                  </DataTrigger>
                </Style.Triggers>
              </Style>
            </Grid.Style>

          </Grid>

          <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="*" />
              <ColumnDefinition Width="auto" />
              <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <controls1:ButtonWithIcon Grid.Column="0"
                                      Margin="0,0,5,0"
                                      HorizontalAlignment="Right"
                                      BorderThickness="0"
                                      Command="{Binding PreviousCommand}"
                                      IconHeight="25"
                                      IconPathStyle="{StaticResource NextSong}"
                                      IconWidth="25"
                                      IsEnabled="{Binding CanPlay}"
                                      RenderTransformOrigin="0.5,0.5">
              <controls1:ButtonWithIcon.RenderTransform>
                <ScaleTransform ScaleX="-1" />
              </controls1:ButtonWithIcon.RenderTransform>
            </controls1:ButtonWithIcon>

            <Button x:Name="Play_Button"
                    Grid.Column="1"
                    Margin="7"
                    Padding="15"
                    Background="{StaticResource DefaultRedBrush}"
                    BorderThickness="0"
                    Command="{Binding PlayButton}"
                    Style="{StaticResource PlayButton}" />

            <controls1:ButtonWithIcon Grid.Column="2"
                                      Margin="0,0,5,0"
                                      BorderThickness="0"
                                      Command="{Binding NextCommand}"
                                      IconHeight="25"
                                      IconPathStyle="{StaticResource NextSong}"
                                      IconWidth="25"
                                      IsEnabled="{Binding CanPlay}"
                                      RenderTransformOrigin="0.5,0.5" />
          </Grid>

          <Grid.Style>
            <Style TargetType="Grid">
              <Style.Triggers>
                <DataTrigger Binding="{Binding IsFullScreen}" Value="True">
                  <Setter Property="Background" Value="#90252525" />
                </DataTrigger>
              </Style.Triggers>
            </Style>
          </Grid.Style>
        </Grid>


        <ContentPresenter HorizontalAlignment="Right"
                          Content="{Binding StatusMessage}"
                          ContentTemplate="{StaticResource StatusMessageDataTemplate}" />
      </Grid>

      <b:Interaction.Behaviors>
        <behaviors1:ShowHideMouseBehavior />
      </b:Interaction.Behaviors>
    </Border>
  </Grid>
</UserControl>
